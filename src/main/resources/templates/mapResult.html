<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>マップ選択結果</title>
    <link rel="stylesheet" href="/css/mapResult.css">
</head>
<body>

    <div class="result-container" id="result-container">
        <!-- チーム名と選ばれたマップを表示 -->
        <div class="result-message" th:text="${session.team.teamName1} + 'によって'"></div>
        <div class="result-message" th:text="${session.banMap[session.banMap.size() - 1].maps_name}"></div>
        <div class="result-message" th:text="'が選ばれました'"></div>

        <!-- 最後のBANされたマップ画像を表示 -->
        <img class="map-image" 
             th:src="@{'/' + ${session.banMap[session.banMap.size() - 1].maps_name} + '.PNG'}" 
             alt="選ばれたマップ画像" id="mapImage" />

        <!-- カウントダウン -->
        <div id="countdown" class="countdown">10</div>

        <!-- フェードインするメッセージ -->
        <div class="fade-in-message" id="fade-message">キャラクター選択へ移ります</div>
    </div>

    <script>
        let countdownValue = 10; // カウントダウンの初期値

        // 背景画像として選ばれたマップの画像を設定
        const mapImage = document.getElementById('mapImage');
        const resultContainer = document.getElementById('result-container');
        const mapImagePath = '/' + '${session.banMap[session.banMap.size() - 1].maps_name}' + '.PNG';
        resultContainer.style.backgroundImage = `url(${mapImagePath})`;

        // カウントダウンを表示
        const countdownElement = document.getElementById('countdown');
        
        const countdownInterval = setInterval(function() {
            countdownElement.textContent = countdownValue; // カウントダウンを更新

            // カウントダウンが9になったらメッセージをフェードイン
            if (countdownValue === 9) {
                clearInterval(countdownInterval); // カウントダウンを停止
                setTimeout(function() {
                    // フェードインメッセージ表示
                    document.getElementById('fade-message').style.display = 'block';
                    document.getElementById('fade-message').style.opacity = 1;

                    // さらに5秒後にリダイレクト
                    setTimeout(function() {
                        window.location.href = '/characterSelect'; // CharacterPickControllerのCharacterBanメソッドに遷移
                    }, 5000); // メッセージ表示後5秒後にリダイレクト
                }, 1000); // 1秒待ってからメッセージを表示
            }

            countdownValue--; // カウントダウンを1秒ごとに減らす
        }, 1000); // 1秒ごとにカウントダウンを更新
    </script>

</body>
</html>
